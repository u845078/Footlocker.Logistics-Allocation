@{
    ViewBag.Title = "NetworkUpload";
}

<fieldset>
    <legend> Network Upload </legend>
    This matches Jay's spreadsheet format  <br />
    <br />
    <br />
    <b>Please select spreadsheets: </b>
        <br />
        <br />Champs<br />
    @(Html.Telerik().Upload()
            .Name("attachmentsChamps")
            .Multiple(true)
            .Async(async => async
            .Save("SaveBTSChamps", "Upload")
            .AutoUpload(false))
            .ShowFileList(true)
            .ClientEvents(events => events
            .OnError("onError")
            .OnSelect("onSelect")
            .OnSuccess("onSuccess")
            )
        )

<br />Europe<br />
    @(Html.Telerik().Upload()
        .Name("attachmentsEurope")
        .Multiple(true)
        .Async(async => async
                    .Save("SaveBTSEurope", "Upload")
            .AutoUpload(false))
            .ShowFileList(true)
        .ClientEvents(events => events
            .OnError("onError")
            .OnSelect("onSelect")
                    .OnSuccess("onSuccess")
            )
        )

<br />Lockers<br />
    @(Html.Telerik().Upload()
        .Name("attachmentsLocker")
        .Multiple(true)
        .Async(async => async
                    .Save("SaveBTSLocker", "Upload")
            .AutoUpload(false))
            .ShowFileList(true)
        .ClientEvents(events => events
            .OnError("onError")
            .OnSelect("onSelect")
                    .OnSuccess("onSuccess")
            )
        )

        <input type="submit" id="spreadsheet" name="create" value="Upload" class="t-button" style="width:150px; visibility: hidden;display:none;"/>
        <br />
        <h4> <div id="message"></div> </h4>
</fieldset>
 
     <script type="text/javascript">

         function onSelect(e) {
             var files = e.files;
             if (files[0].extension != ".xls") {
                 alert("Document must be a spreadsheet with a xls extension. ");
                 e.preventDefault();
             }
             else {
                 document.getElementById('spreadsheet').style.visibility = 'visible';
             }
             $('#message').empty();
         }

         function onError(e) {
             var message = e.XMLHttpRequest.responseText;
             $('#message').empty().append("<font color='red'>" + message + "</font><br><a class='t-button' href='DownloadProductErrors'>Download Errors</a>");

             e.preventDefault();
         }

         function onSuccess(e) {
             var message = e.XMLHttpRequest.responseText;
             $('#message').empty().append("<font color='red'>Success</font>");

             e.preventDefault();
         }
    </script>
    